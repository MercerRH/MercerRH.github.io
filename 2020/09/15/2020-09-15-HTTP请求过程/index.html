<!DOCTYPE html><html lang="zh-CN" data-theme="light"><head><meta charset="UTF-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width,initial-scale=1"><title>HTTP请求过程 | 若花巡的小屋</title><meta name="description" content="HTTP请求的大致流程 域名解析 建立TCP连接 发起HTTP请求 获取资源 资源解析 页面渲染  域名解析域名解析是把域名指向网站空间 IP，让人们通过注册的域名可以方便地访问到网站的一种服务。为了方便记忆，人们采用域名来代替 IP 地址标识站点地址。域名解析就是域名到IP地址的转换过程。域名的解析工作由 DNS 服务器完成。 DNS( Domain Name System)是“域名系统”的英文"><meta name="keywords" content="HTTP"><meta name="author" content="莫瑟,mercerfuran@gmail.com"><meta name="copyright" content="莫瑟"><meta name="format-detection" content="telephone=no"><meta name="theme-color" content="#ffffff"><meta http-equiv="Cache-Control" content="no-transform"><meta http-equiv="Cache-Control" content="no-siteapp"><link rel="shortcut icon" href="/img/favicon.png"><link rel="canonical" href="https://mercerrh.github.io/2020/09/15/2020-09-15-HTTP%E8%AF%B7%E6%B1%82%E8%BF%87%E7%A8%8B/"><link rel="preconnect" href="//cdn.jsdelivr.net"/><link rel="preconnect" href="//busuanzi.ibruce.info"/><meta property="og:type" content="article"><meta property="og:title" content="HTTP请求过程"><meta property="og:url" content="https://mercerrh.github.io/2020/09/15/2020-09-15-HTTP%E8%AF%B7%E6%B1%82%E8%BF%87%E7%A8%8B/"><meta property="og:site_name" content="若花巡的小屋"><meta property="og:description" content="HTTP请求的大致流程 域名解析 建立TCP连接 发起HTTP请求 获取资源 资源解析 页面渲染  域名解析域名解析是把域名指向网站空间 IP，让人们通过注册的域名可以方便地访问到网站的一种服务。为了方便记忆，人们采用域名来代替 IP 地址标识站点地址。域名解析就是域名到IP地址的转换过程。域名的解析工作由 DNS 服务器完成。 DNS( Domain Name System)是“域名系统”的英文"><meta property="og:image" content="https://mercerrh.github.io/img/avatar.png"><meta property="article:published_time" content="2020-09-15T07:52:00.000Z"><meta property="article:modified_time" content="2020-09-17T09:48:58.247Z"><meta name="twitter:card" content="summary"><link rel="stylesheet" href="/css/index.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free/css/all.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fancyapps/fancybox@latest/dist/jquery.fancybox.min.css"><script>var GLOBAL_CONFIG = { 
  root: '/',
  hexoversion: '4.2.1',
  algolia: undefined,
  localSearch: undefined,
  translate: undefined,
  noticeOutdate: undefined,
  highlight: {"plugin":"highlighjs","highlightCopy":true,"highlightLang":true},
  copy: {
    success: '复制成功',
    error: '复制错误',
    noSupport: '浏览器不支持'
  },
  bookmark: {
    message_prev: '按',
    message_next: '键将本页加入书签'
  },
  runtime: '',
  date_suffix: {"one_hour":"刚刚","hours":"小时前","day":"天前"},
  copyright: undefined,
  ClickShowText: undefined,
  medium_zoom: false,
  fancybox: true,
  Snackbar: undefined,
  justifiedGallery: {
    js: 'https://cdn.jsdelivr.net/npm/justifiedGallery/dist/js/jquery.justifiedGallery.min.js',
    css: 'https://cdn.jsdelivr.net/npm/justifiedGallery/dist/css/justifiedGallery.min.css'
  },
  baiduPush: false,
  isPhotoFigcaption: false,
  islazyload: false,
  isanchor: false
};

var saveToLocal = {
  set: function setWithExpiry(key, value, ttl) {
    const now = new Date()
    const expiryDay = ttl * 86400000
    const item = {
      value: value,
      expiry: now.getTime() + expiryDay,
    }
    localStorage.setItem(key, JSON.stringify(item))
    },

  get: function getWithExpiry(key) {
    const itemStr = localStorage.getItem(key)

    if (!itemStr) {
      return undefined
    }
    const item = JSON.parse(itemStr)
    const now = new Date()

    if (now.getTime() > item.expiry) {
      localStorage.removeItem(key)
      return undefined
    }
    return item.value
  }
}</script><script id="config_change">var GLOBAL_CONFIG_SITE = { 
  isPost: true,
  isHome: false,
  isHighlightShrink: false,
  isSidebar: true,
  postUpdate: '2020-09-17 17:48:58'
}</script><noscript><style type="text/css">
#nav {
  opacity: 1
}
.justified-gallery img {
  opacity: 1
}
</style></noscript><script>var activateDarkMode = function () {
  document.documentElement.setAttribute('data-theme', 'dark')
  if (document.querySelector('meta[name="theme-color"]') !== null) {
    document.querySelector('meta[name="theme-color"]').setAttribute('content', '#0d0d0d')
  }
}
var activateLightMode = function () {
  document.documentElement.setAttribute('data-theme', 'light')
  if (document.querySelector('meta[name="theme-color"]') !== null) {
    document.querySelector('meta[name="theme-color"]').setAttribute('content', '#ffffff')
  }
}

var autoChangeMode = 'false'
var t = saveToLocal.get('theme')
if (autoChangeMode === '1') {
  var isDarkMode = window.matchMedia('(prefers-color-scheme: dark)').matches
  var isLightMode = window.matchMedia('(prefers-color-scheme: light)').matches
  var isNotSpecified = window.matchMedia('(prefers-color-scheme: no-preference)').matches
  var hasNoSupport = !isDarkMode && !isLightMode && !isNotSpecified

  if (t === undefined) {
    if (isLightMode) activateLightMode()
    else if (isDarkMode) activateDarkMode()
    else if (isNotSpecified || hasNoSupport) {
      var now = new Date()
      var hour = now.getHours()
      var isNight = hour <= 6 || hour >= 18
      isNight ? activateDarkMode() : activateLightMode()
    }
    window.matchMedia('(prefers-color-scheme: dark)').addListener(function (e) {
      if (saveToLocal.get('theme') === undefined) {
        e.matches ? activateDarkMode() : activateLightMode()
      }
    })
  } else if (t === 'light') activateLightMode()
  else activateDarkMode()
} else if (autoChangeMode === '2') {
  now = new Date()
  hour = now.getHours()
  isNight = hour <= 6 || hour >= 18
  if (t === undefined) isNight ? activateDarkMode() : activateLightMode()
  else if (t === 'light') activateLightMode()
  else activateDarkMode()
} else {
  if (t === 'dark') activateDarkMode()
  else if (t === 'light') activateLightMode()
}</script><meta name="generator" content="Hexo 4.2.1"></head><body><div id="loading-box"><div class="loading-left-bg"></div><div class="loading-right-bg"></div><div class="spinner-box"><div class="configure-border-1"><div class="configure-core"></div></div><div class="configure-border-2"><div class="configure-core"></div></div><div class="loading-word">加载中...</div></div></div><div id="mobile-sidebar"><div id="menu_mask"></div><div id="mobile-sidebar-menus"><div class="mobile_author_icon"><img class="avatar-img" src="/img/avatar.png" onerror="onerror=null;src='/img/friend_404.gif'" alt="avatar"/></div><div class="mobile_post_data"><div class="mobile_data_item is-center"><div class="mobile_data_link"><a href="/archives/"><div class="headline">文章</div><div class="length_num">18</div></a></div></div><div class="mobile_data_item is-center">      <div class="mobile_data_link"><a href="/tags/"><div class="headline">标签</div><div class="length_num">12</div></a></div></div><div class="mobile_data_item is-center">     <div class="mobile_data_link"><a href="/categories/"><div class="headline">分类</div><div class="length_num">5</div></a></div></div></div><hr/><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fas fa-home"></i><span> 首页</span></a></div><div class="menus_item"><a class="site-page" href="/archives/"><i class="fa-fw fas fa-archive"></i><span> 归档</span></a></div><div class="menus_item"><a class="site-page" href="/tags/"><i class="fa-fw fas fa-tags"></i><span> 标签</span></a></div><div class="menus_item"><a class="site-page" href="/categories/"><i class="fa-fw fas fa-folder-open"></i><span> 分类</span></a></div></div></div></div><div id="body-wrap"><div id="web_bg" data-type="photo"></div><div id="sidebar"><i class="fas fa-arrow-right on" id="toggle-sidebar"></i><div class="sidebar-toc"><div class="sidebar-toc__title">目录</div><div class="sidebar-toc__progress"><span class="progress-notice">你已经读了</span><span class="progress-num">0</span><span class="progress-percentage">%</span><div class="sidebar-toc__progress-bar">     </div></div><div class="sidebar-toc__content"><ol class="toc"><li class="toc-item toc-level-3"><a class="toc-link" href="#HTTP请求的大致流程"><span class="toc-number">1.</span> <span class="toc-text">HTTP请求的大致流程</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#域名解析"><span class="toc-number">2.</span> <span class="toc-text">域名解析</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#建立-TCP-连接"><span class="toc-number">3.</span> <span class="toc-text">建立 TCP 连接</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#TCP数据段解析"><span class="toc-number">3.1.</span> <span class="toc-text">TCP数据段解析</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#TCP数据段（TPDU）格式："><span class="toc-number">3.1.1.</span> <span class="toc-text">TCP数据段（TPDU）格式：</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#三次握手"><span class="toc-number">3.2.</span> <span class="toc-text">三次握手</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#四次挥手"><span class="toc-number">3.3.</span> <span class="toc-text">四次挥手</span></a></li></ol></li></ol></div></div></div><header class="post-bg" id="page-header"><nav id="nav"><span id="blog_name"><a id="site-name" href="/">若花巡的小屋</a></span><span id="menus"><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fas fa-home"></i><span> 首页</span></a></div><div class="menus_item"><a class="site-page" href="/archives/"><i class="fa-fw fas fa-archive"></i><span> 归档</span></a></div><div class="menus_item"><a class="site-page" href="/tags/"><i class="fa-fw fas fa-tags"></i><span> 标签</span></a></div><div class="menus_item"><a class="site-page" href="/categories/"><i class="fa-fw fas fa-folder-open"></i><span> 分类</span></a></div></div><span class="close" id="toggle-menu"><a class="site-page"><i class="fas fa-bars fa-fw"></i></a></span></span></nav><div id="post-info"><div id="post-title"><div class="posttitle">HTTP请求过程</div></div><div id="post-meta"><div class="meta-firstline"><span class="post-meta-date"><i class="far fa-calendar-alt fa-fw post-meta-icon"></i><span class="post-meta-label">发表于</span><time class="post-meta-date-created" datetime="2020-09-15T07:52:00.000Z" title="发表于 2020-09-15 15:52:00">2020-09-15</time><span class="post-meta-separator">|</span><i class="fas fa-history fa-fw post-meta-icon"></i><span class="post-meta-label">更新于</span><time class="post-meta-date-updated" datetime="2020-09-17T09:48:58.247Z" title="更新于 2020-09-17 17:48:58">2020-09-17</time></span><span class="post-meta-categories"><span class="post-meta-separator">|</span><i class="fas fa-inbox fa-fw post-meta-icon"></i><a class="post-meta-categories" href="/categories/%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C/">计算机网络</a></span></div><div class="meta-secondline"> <span class="post-meta-separator">|</span><span class="post-meta-wordcount"><i class="far fa-file-word fa-fw post-meta-icon"></i><span class="post-meta-label">字数总计:</span><span class="word-count">3.1k</span><span class="post-meta-separator">|</span><i class="far fa-clock fa-fw post-meta-icon"></i><span class="post-meta-label">阅读时长:</span><span>9分钟</span></span><span class="post-meta-separator">|</span><span class="post-meta-pv-cv"><i class="far fa-eye fa-fw post-meta-icon"></i><span class="post-meta-label">阅读量:</span><span id="busuanzi_value_page_pv"></span></span></div></div></div></header><main class="layout_post" id="content-inner"><article id="post"><div class="post-content" id="article-container"><h3 id="HTTP请求的大致流程"><a href="#HTTP请求的大致流程" class="headerlink" title="HTTP请求的大致流程"></a>HTTP请求的大致流程</h3><ol>
<li>域名解析</li>
<li>建立TCP连接</li>
<li>发起HTTP请求</li>
<li>获取资源</li>
<li>资源解析</li>
<li>页面渲染</li>
</ol>
<h3 id="域名解析"><a href="#域名解析" class="headerlink" title="域名解析"></a>域名解析</h3><p>域名解析是把域名指向网站空间 IP，让人们通过注册的域名可以方便地访问到网站的一种服务。为了方便记忆，人们采用域名来代替 IP 地址标识站点地址。域名解析就是域名到IP地址的转换过程。域名的解析工作由 DNS 服务器完成。</p>
<p><code>DNS</code>( Domain Name System)是“域名系统”的英文缩写，DNS 是应用层协议，事实上他是为其他应用层协议工作的，包括不限于 HTTP 和 SMTP 以及 FTP，用于将用户提供的主机名解析为 ip 地址。</p>
<p><strong>DNS解析的过程：</strong></p>
<ul>
<li>在浏览器中输入 url 地址，浏览器搜索自身的 DNS 缓存，若找到未过期的条目则解析结束。</li>
<li>上一步未成功的话，浏览器会搜索操作系统的 DNS 缓存，若找到未过期的条目则解析结束。</li>
<li>上一步未成功的话，浏览器会尝试读取 hosts 文件，若里面有该域名对应的 ip 地址则解析结束。</li>
<li>上一步未成功的话，查找 TCP/ip 设置中的首选 DNS 服务器，若 DNS 服务器中包含了要查询的域名，则将结果返回可客户机，解析结束。</li>
<li>上一步未成功的话，则由 DNS 服务器为我们发起迭代的 DNS 解析请求，首先找到根 DNS，对根 DNS 发起请求 ，根 DNS 会根据域名返回 url 地址对应的顶级域的 IP 地址；接着对顶级域发起请求，顶级域又将下一级 DNS 的 IP 返回给浏览器……直至解析成功。</li>
<li>若上面的步骤均未成功，则会继续查找 NetBIOS name Cache、未成功则查找 WINS 服务器、未成功则进行广播查找、未成功则读取 LMHOSTS 文件，仍为成功的话，则宣告本次解析失败，无法进行通信。</li>
</ul>
<h3 id="建立-TCP-连接"><a href="#建立-TCP-连接" class="headerlink" title="建立 TCP 连接"></a>建立 TCP 连接</h3><h4 id="TCP数据段解析"><a href="#TCP数据段解析" class="headerlink" title="TCP数据段解析"></a>TCP数据段解析</h4><p>TCP数据是以数据段的形式进行传输。数据段的长度被两个因素所限制：</p>
<ul>
<li>TCP数据段必须适合IP分组的 65515 字节（65535B~20B）的载荷限制</li>
<li>TCP数据段必须适合于下层网络的MTU</li>
</ul>
<h5 id="TCP数据段（TPDU）格式："><a href="#TCP数据段（TPDU）格式：" class="headerlink" title="TCP数据段（TPDU）格式："></a>TCP数据段（TPDU）格式：</h5><p>TCP 报文段的报头有 10 个必需的字段和 1 个可选字段。报头至少为 20 字节。报头后面的数据是可选项。</p>
<p><strong>报头的10字段：</strong></p>
<ol>
<li><p><strong>源端口</strong>（Source port，16位）</p>
<p>表示发送报文的计算机端口或进程。一个 TCP 报文短必须包括源端口号，使目的主机知道一个向何处发送确认报文。</p>
</li>
<li><p><strong>目的端口</strong>（Destination port，16位）</p>
<p>标识接收报文的目的主机的端口或进程。</p>
</li>
<li><p><strong>序列号</strong>（Sequence number，32位）</p>
<p>用于标识每个报文段，使目的主机可确认已收到指定报文段中的数据。当源主机用于多个报文段发送一个报文时，即使这些报文到达目的主机的顺序不一样，序列号也可以使目的主机按顺序排列它们。序列号中有一个特殊的序列号称为初始序列号 ( ISNs ) 。</p>
<p>在 SYN 标志未置位时，该字段指示了用户数据区中第一个字节的序号；在 SYN 标志置位时，该字段指示的是初始发送的序列号。</p>
<p>在建立连接时发送的第一个报文段中，双方都提供一个初始序列号。TCP 标准推荐使用以 4ms 间隔递增 1 的计数器值作为这个初始序列号的值。使用计数器可以防止连接关闭再重新连接时出现相同的序列号。</p>
<p>对于那些包含数据的报文段，报文段中第一个数据字节的数量就是初始序列号，其后数据字节按顺序编号。如果源主机使用同样的连接发送另一个报文段，那么这个报文段的序列号等于前一个报文段的序列号与前一个报文段中数据字节的数量之和。例如，假设源主机发送 3 个报文段，每个报文段有 100 字节的数据，且第一个报文段的序列号是 1000，那么第二个报文段的序列号就是 1100（1000 + 100），第三个报文段的序列号就是 1200（1100 + 100）。</p>
<p>如果序列号增大至最大值将复位为 0。</p>
</li>
<li><p><strong>确认号</strong>（Acknowledgement number，32位）</p>
<p>目的主机返回确认号，使源主机知道某个或几个报文段已被接收。如果 ACK 控制位被设置为 1，则该字段有效。确认号等于顺序接收到的最后一个报文段的序号加 1，这也是目的主机希望下次接收的报文段的序号值。返回确认号后，计算机认为已接收到小于该确认号的所有数据。</p>
<p>例如，序列号等于前一个报文段的序列号与前一个报文段中数据字节的数量之和。例如，假设源主 机发送 3 个报文段，每个报文段有 100 字节的数据，且第一个报文段的序列号是 1000，那么接收到第一个报文段后，目的主机返回含确认号1100 的报头。接收到第二个报文段（其序号为 1100 ）后，目的主机返回确认号 1200。接收到第三个报文段后，目的主机返回确认号 1300 。</p>
<p>目的主机不一定在每次接收到报文段后都返回确认号。在上面的例子中，目的主机可能等到所有 3 个报文段都收到后，再返回一个含确认号 1300 的报文段，表示已接收到全部 1200 字节的数据。但是如果目的主机再发回确认号之前等待时间过长，源主机会认为数据没有到达目的主机，并自动重发。</p>
<p>上面的例子中，如果目的主机接收到了报文段号为 1000 的第一个报文段以及报文段号为 1200 的最后一个报文段，则可返回确认号 1100，但是再返回确认号 1300 之前，应该等待报文段号为 1100 的中间报文段。</p>
</li>
<li><p><strong>TCP段头长度</strong>（TCP header length，4位）</p>
<p>单位为32位4字节。TCP 报文段的数据起始处距离 TCP 报文段的起始处有多远，即首部长度。 由于 TCP 报头的长度随 TCP 选项字段内容的不同而变化，因此报头中包含一个指定报头字段的字段。该字段以 32 比特为单位，所以报头长度一定是 32 比特的整数倍，有时需要在报头末尾补 0 。如果报头没有 TCP 选项字段，则报头长度值为 5 ，表示报头一个有 160 比特，即 20 字节。</p>
</li>
<li><p><strong>保留位</strong>（6位）</p>
<p>已经开始逐步启用，如拥塞控制。</p>
</li>
<li><p><strong>控制位</strong>（有六个字段，每个1位，共6位）</p>
<ul>
<li><strong>URG</strong>：急指针告诉系统此报文段中有紧急数据，应尽快传送。使用了紧急指针时， URG 置为 1。紧急指针是一个对于当前序列号的字节偏移量，标明紧急数据从哪里开始。紧接收方收到 URG 置为 1 的数据后，马上处理，处理完后恢复正常操作。</li>
<li><strong>ACK</strong>：值可设为 1 或 0。当 ACK = 1 时表示确认号字段有效，TCP 规定，在连接建立后所有传达的报文段都必须把 ACK 置 1。ACK = 0 时表明没有搭载任何确认。</li>
<li><strong>PSH</strong>：表示这是带有 PUSH 标志的数据。接收方收到 PSH = 1 的报文段，就尽快地（即“推送”向前）交付给接收应用进程，而不再等到整个缓存都填满后再向上交付。</li>
<li><strong>RST</strong>：用于重置一个已经非常混乱的链接，如果在连接建立阶段就直接拒绝连接。</li>
<li><strong>SYN</strong>：仅在三次握手建立 TCP 连接时有效。当 SYN = 1 而 ACK = 0 时，表明这是一个连接请求报文段，对方若同意建立连接，则应在相应的报文段中使用 SYN = 1 和 ACK = 1。因此，SYN 置 1 就表示这是一个连接请求或连接接受报文。<ul>
<li>第一次握手：SYN = 1, ACK = 0</li>
<li>第二次握手：SYN = 1, ACK = 1</li>
<li>第三次握手：SYN = 0, ACK = 1</li>
</ul>
</li>
<li><strong>FIN</strong>：用于释放连接，表示发送方已经没有数据要传输了，但仍可以接收数据。当 FIN = 1 时，表明此报文段的发送方的数据已经发送完毕，并要求释放运输连接。</li>
</ul>
</li>
<li><p><strong>窗口尺寸</strong>（Windows size，16位）</p>
<p>用于流量控制，告诉对方可以发送的数据字节数，即从确认字节号开始，连续发送的字节总数，即窗口的大小。该字段可以告诉对方在不等待确认的情况下，可以发来多大的数据。这里表示的最大长度是2^16 - 1 = 65535，如需要使用更大的窗口大小，需要使用选项中的窗口扩大因子选项。</p>
</li>
<li><p><strong>校验和</strong>（Checksum， 16位）</p>
<p>源主机和目的主机根据 TCP 报文段以及伪报头的内容计算校验和。在伪报头中存放着来自 IP 报头以及 TCP 报文段长度信息。与 UDP 一样，伪报头并不在网络中传输，并且在校验和中包含伪报头的目的是为了防止目的主机错误地接收存在路由的错误数据报。</p>
<p>伪首部， 又称为伪报头（Pseudo Header）：是指在 TCP 的分段或 UDP 的数据报格式中，在数据报首部前面增加源 IP 地址、目的 IP 地址、IP 分组的协议字段、TCP 或 UDP 数据报的总长度等共12字节，所构成的扩展首部结构。此伪首部是一个临时的结构，它既不向上也不向下传递，仅仅只是为了保证可以校验套接字的正确性。</p>
</li>
<li><p><strong>紧急指针</strong>（Urgent pointer，16位）</p>
<p>配合 URG 控制位使用，指明了紧急数据的字节数（紧急数据结束后就是普通数据），即指出了紧急数据的末尾在报文中的位置，注意：即使窗口为零时也可发送紧急数据。</p>
</li>
</ol>
<p><strong>若有选项域：</strong></p>
<ul>
<li><p><strong>选项、填充字段</strong></p>
<p>可能包括“窗口扩大因子”、“时间戳”等选项。长度可变，最长可达 40 字节，当没有使用选项时，TCP 首部长度是 20 字节。填充用于保证任选项为 32bit 的整数倍。</p>
</li>
<li><p><strong>数据</strong>（长度可变）</p>
<p>TCP 首部结束之后的部分</p>
</li>
</ul>
<h4 id="三次握手"><a href="#三次握手" class="headerlink" title="三次握手"></a>三次握手</h4><p><img src="./post_img/2020-09-15/01.jpg" alt=""></p>
<ol>
<li><p>Client首先发送一个连接试探，ACK=0 表示确认号无效，SYN = 1 表示这是一个连接请求或连接接受报文，同时表示这个数据报不能携带数据，seq = x 表示Client自己的初始序号（seq = 0 就代表这是第0号包），这时候Client进入syn_sent状态，表示客户端等待服务器的回复</p>
</li>
<li><p>Server监听到连接请求报文后，如同意建立连接，则向Client发送确认。TCP报文首部中的SYN 和 ACK都置1 ，ack = x + 1表示期望收到对方下一个报文段的第一个数据字节序号是x+1，同时表明x为止的所有数据都已正确收到（ack=1其实是ack=0+1,也就是期望客户端的第1个包），seq = y 表示Server 自己的初始序号（seq=0就代表这是服务器这边发出的第0号包）。这时服务器进入syn_rcvd，表示服务器已经收到Client的连接请求，等待client的确认。</p>
</li>
<li><p>Client收到确认后还需再次发送确认，同时携带要发送给Server的数据。ACK 置1 表示确认号ack= y + 1 有效（代表期望收到服务器的第1个包），Client自己的序号seq= x + 1（表示这就是我的第1个包，相对于第0个包来说的），一旦收到Client的确认之后，这个TCP连接就进入Established状态，就可以发起http请求了。</p>
</li>
</ol>
<h4 id="四次挥手"><a href="#四次挥手" class="headerlink" title="四次挥手"></a>四次挥手</h4></div><div class="post-copyright"><div class="post-copyright__author"><span class="post-copyright-meta">文章作者: </span><span class="post-copyright-info"><a href="mailto:mercerfuran@gmail.com">莫瑟</a></span></div><div class="post-copyright__type"><span class="post-copyright-meta">文章链接: </span><span class="post-copyright-info"><a href="https://mercerrh.github.io/2020/09/15/2020-09-15-HTTP%E8%AF%B7%E6%B1%82%E8%BF%87%E7%A8%8B/">https://mercerrh.github.io/2020/09/15/2020-09-15-HTTP%E8%AF%B7%E6%B1%82%E8%BF%87%E7%A8%8B/</a></span></div><div class="post-copyright__notice"><span class="post-copyright-meta">版权声明: </span><span class="post-copyright-info">本博客所有文章除特别声明外，均采用 <a href="https://creativecommons.org/licenses/by-nc-sa/4.0/" target="_blank">CC BY-NC-SA 4.0</a> 许可协议。转载请注明来自 <a href="https://mercerrh.github.io" target="_blank">若花巡的小屋</a>！</span></div></div><div class="tag_share"><div class="post-meta__tag-list"><a class="post-meta__tags" href="/tags/HTTP/">HTTP</a></div><div class="post_share"><div class="social-share" data-image="/img/avatar.png" data-sites="facebook,twitter,wechat,weibo,qq"></div><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/social-share.js/dist/css/share.min.css"><script src="https://cdn.jsdelivr.net/npm/social-share.js/dist/js/social-share.min.js" defer></script></div></div><nav class="pagination-post" id="pagination"><div class="next-post pull-full"><a href="/2020/09/11/2020-09-11-%E4%BD%BF%E7%94%A8Scrapy%E7%88%AC%E5%8F%96%E3%80%8A%E4%B8%BA%E8%B0%81%E8%80%8C%E7%82%BC%E9%87%91wiki%E3%80%8B%E4%B8%AD%E6%89%80%E6%9C%89%E8%A7%92%E8%89%B2%E7%9A%84%E7%AB%8B%E7%BB%98/"><img class="next-cover" src="/null" onerror="onerror=null;src='/img/404.jpg'"><div class="pagination-info"><div class="label">下一篇</div><div class="next_info">使用 Scrapy 爬取《为谁而炼金wiki》中所有角色的立绘</div></div></a></div></nav></article></main><footer id="footer" data-type="color"><div id="footer-wrap"><div class="copyright">&copy;2020 By 莫瑟</div><div class="framework-info"><span>框架 </span><a href="https://hexo.io" target="_blank" rel="noopener">Hexo</a><span class="footer-separator">|</span><span>主题 </span><a href="https://github.com/jerryc127/hexo-theme-butterfly" target="_blank" rel="noopener">Butterfly</a></div></div></footer></div><section id="rightside"><div id="rightside-config-hide"><button id="readmode" type="button" title="阅读模式"><i class="fas fa-book-open"></i></button><button id="darkmode" type="button" title="浅色和深色模式转换"><i class="fas fa-adjust"></i></button></div><div id="rightside-config-show"><button id="rightside_config" type="button" title="设置"><i class="fas fa-cog"></i></button><button class="close" id="mobile-toc-button" type="button" title="目录"><i class="fas fa-list-ul"></i></button><button id="go-up" type="button" title="回到顶部"><i class="fas fa-arrow-up"></i></button></div></section><div><script src="https://cdn.jsdelivr.net/npm/jquery@latest/dist/jquery.min.js"></script><script src="/js/utils.js"></script><script src="/js/main.js"></script><script src="https://cdn.jsdelivr.net/npm/@fancyapps/fancybox@latest/dist/jquery.fancybox.min.js"></script><script>var endLoading = function () {
  document.body.style.overflow = 'auto';
  document.getElementById('loading-box').classList.add("loaded")
}
window.addEventListener('load',endLoading)</script><div class="js-pjax"><script async src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script></div></div></body></html>